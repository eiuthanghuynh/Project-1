<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>FastFeast Admin - Manage Products</title>

    <!-- jQuery -->
    <script
        src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-3gJwYp8M6Y3b7Yk0p2j3y3s+7r2a4u2G3XW5f5y5Y3s="
        crossorigin="anonymous"></script>

    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        body { font-family: Arial, Helvetica, sans-serif; margin: 20px; background:#f7f7f7; color:#222; }
        h1 { margin-bottom: 6px; }
        .container { max-width: 1000px; margin: 0 auto; background: #fff; padding: 18px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
        form { display:flex; gap:12px; flex-wrap:wrap; align-items:flex-start; margin-bottom:16px; }
        form .col { flex:1 1 220px; min-width:160px; display:flex; flex-direction:column; }
        label { font-size:13px; margin-bottom:6px; color:#333; }
        input[type="text"], input[type="number"], textarea { padding:8px; border-radius:4px; border:1px solid #ccc; font-size:14px; width:100%; box-sizing:border-box; }
        textarea { resize:vertical; min-height:56px; }
        .actions { display:flex; gap:8px; align-items:center; }
        button { padding:8px 12px; border:0; border-radius:4px; background:#1976d2; color:white; cursor:pointer; }
        button.secondary { background:#6c757d; }
        button.danger { background:#d32f2f; }
        table { width:100%; border-collapse:collapse; margin-top:12px; }
        th, td { text-align:left; padding:10px 12px; border-bottom:1px solid #eee; vertical-align:middle; }
        th { background:#fafafa; font-weight:600; font-size:13px; }
        img.thumb { width:64px; height:48px; object-fit:cover; border-radius:4px; border:1px solid #ddd; }
        .muted { color:#777; font-size:13px; }
        .empty { text-align:center; padding:18px; color:#666; }
        @media (max-width:720px) {
            form { flex-direction:column; }
            .actions { width:100%; justify-content:flex-start; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>FastFeast â€” Product Manager</h1>
        <p class="muted">Add, edit or remove products. Data persists in your browser (localStorage).</p>

        <form id="product-form" onsubmit="return false;">
            <input type="hidden" id="product-id" value="">
            <div class="col">
                <label for="product-name">Name</label>
                <input id="product-name" type="text" placeholder="Product name" required>
            </div>
            <div class="col">
                <label for="product-price">Price</label>
                <input id="product-price" type="number" step="0.01" min="0" placeholder="0.00" required>
            </div>
            <div class="col">
                <label for="product-image">Image URL (optional)</label>
                <input id="product-image" type="text" placeholder="https://...">
            </div>
            <div style="flex:1 1 100%;">
                <label for="product-desc">Description</label>
                <textarea id="product-desc" placeholder="Short description"></textarea>
            </div>
            <div class="actions" style="margin-left:auto;">
                <button id="save-btn" type="button">Add Product</button>
                <button id="cancel-btn" type="button" class="secondary" style="display:none;">Cancel</button>
            </div>
        </form>

        <input id="search" type="text" placeholder="Search products..." style="width:100%; padding:8px; margin-bottom:12px; border-radius:4px; border:1px solid #ccc;">

        <table id="products-table" aria-live="polite">
            <thead>
                <tr>
                    <th style="width:6%;">ID</th>
                    <th style="width:18%;">Name</th>
                    <th style="width:10%;">Price</th>
                    <th style="width:34%;">Description</th>
                    <th style="width:14%;">Image</th>
                    <th style="width:20%;">Actions</th>
                </tr>
            </thead>
            <tbody id="products-body">
                <tr class="empty"><td colspan="6">No products yet. Add your first product above.</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        // Simple product manager using localStorage and jQuery
        (function($) {
            const STORAGE_KEY = 'ff_products';

            function loadProducts() {
                const raw = localStorage.getItem(STORAGE_KEY);
                return raw ? JSON.parse(raw) : [];
            }

            function saveProducts(list) {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
            }

            function generateId() {
                return 'p' + Date.now().toString(36) + Math.floor(Math.random()*1000).toString(36);
            }

            function formatPrice(n) {
                return Number(n).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            }

            function renderProducts(filter) {
                const list = loadProducts();
                const $body = $('#products-body').empty();
                const filtered = (filter && filter.trim()) ? list.filter(p => {
                    const q = filter.toLowerCase();
                    return p.name.toLowerCase().includes(q) || (p.description || '').toLowerCase().includes(q) || (p.id || '').toLowerCase().includes(q);
                }) : list;

                if (!filtered.length) {
                    $body.append('<tr class="empty"><td colspan="6">No products found.</td></tr>');
                    return;
                }

                filtered.forEach(p => {
                    const $tr = $('<tr>').attr('data-id', p.id);
                    const imgHtml = p.image ? '<img class="thumb" src="'+escapeHtml(p.image)+'" alt="thumb">' : '';
                    $tr.append('<td>' + escapeHtml(p.id) + '</td>');
                    $tr.append('<td>' + escapeHtml(p.name) + '</td>');
                    $tr.append('<td>$' + formatPrice(p.price) + '</td>');
                    $tr.append('<td>' + escapeHtml(p.description || '') + '</td>');
                    $tr.append('<td>' + imgHtml + '</td>');
                    const $actions = $('<td>');
                    const $edit = $('<button class="secondary">Edit</button>').on('click', () => startEdit(p.id));
                    const $del = $('<button class="danger">Delete</button>').on('click', () => removeProduct(p.id));
                    $actions.append($edit).append(' ').append($del);
                    $tr.append($actions);
                    $body.append($tr);
                });
            }

            function escapeHtml(s) {
                if (!s) return '';
                return String(s).replace(/[&<>"']/g, function(m) {
                    return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m];
                });
            }

            function resetForm() {
                $('#product-id').val('');
                $('#product-name').val('');
                $('#product-price').val('');
                $('#product-desc').val('');
                $('#product-image').val('');
                $('#save-btn').text('Add Product');
                $('#cancel-btn').hide();
            }

            function startEdit(id) {
                const list = loadProducts();
                const p = list.find(x => x.id === id);
                if (!p) return alert('Product not found');
                $('#product-id').val(p.id);
                $('#product-name').val(p.name);
                $('#product-price').val(p.price);
                $('#product-desc').val(p.description || '');
                $('#product-image').val(p.image || '');
                $('#save-btn').text('Update Product');
                $('#cancel-btn').show();
                $('html,body').animate({ scrollTop: 0 }, 200);
            }

            function addOrUpdate() {
                const id = $('#product-id').val();
                const name = $('#product-name').val().trim();
                const price = $('#product-price').val();
                const description = $('#product-desc').val().trim();
                const image = $('#product-image').val().trim();

                if (!name) return alert('Name is required.');
                if (price === '' || isNaN(price)) return alert('Price is required and must be a number.');

                const list = loadProducts();

                if (id) {
                    // update
                    const idx = list.findIndex(p => p.id === id);
                    if (idx === -1) return alert('Product not found');
                    list[idx] = Object.assign({}, list[idx], { name, price: Number(price), description, image });
                    saveProducts(list);
                    resetForm();
                    renderProducts($('#search').val());
                } else {
                    // create
                    const newProduct = {
                        id: generateId(),
                        name,
                        price: Number(price),
                        description,
                        image
                    };
                    list.unshift(newProduct);
                    saveProducts(list);
                    resetForm();
                    renderProducts($('#search').val());
                }
            }

            function removeProduct(id) {
                if (!confirm('Delete this product?')) return;
                const list = loadProducts();
                const next = list.filter(p => p.id !== id);
                saveProducts(next);
                renderProducts($('#search').val());
            }

            $(function() {
                // initial seed (optional) - only if empty
                if (!localStorage.getItem(STORAGE_KEY)) {
                    const seed = [
                        { id: generateId(), name: 'Classic Burger', price: 5.99, description: 'Juicy beef patty, lettuce, tomato, cheese.', image: '' },
                        { id: generateId(), name: 'Veggie Wrap', price: 4.49, description: 'Mixed veggies and hummus in whole wheat.', image: '' },
                        { id: generateId(), name: 'Fries', price: 2.49, description: 'Crispy golden fries.', image: '' }
                    ];
                    saveProducts(seed);
                }

                renderProducts();

                $('#save-btn').on('click', addOrUpdate);
                $('#cancel-btn').on('click', function() { resetForm(); });

                $('#search').on('input', function() {
                    renderProducts($(this).val());
                });
            });

        })(jQuery);
    </script>
</body>
</html>